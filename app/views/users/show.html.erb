<%= @user.email %><br/>
<div>
  <% @user.projects.each do |project| %>

    <p><%= project.name %></p>
    
    <div>
      <div class"columns on-<%= project.tasks.length%>">
        <% unless project.tasks.empty? %>
        <div ="column">
          <% project.tasks.each do |task| %>
            <% if task.user_id == @user.id %>
              <%= task.content %>
              <%# unless task.comments.empty?%>
              <ul>
              <% task.comments.each do |cmt| %>
                <li><%= cmt.content %> by <%= cmt.author %></li>
              <% end %>
              </ul>
              <%# end %>
              <% form_for [task, @comment] do |g| %>
                  <%= g.label :content, 'Comment' %>
                  <%= g.text_field :content %> by 
                  <%= g.text_field :author %>
                  <%= g.submit 'Comment!' %>
              <% end %>
            <% end %>
          <% end %>
        </div>
        <% end %>
      </div>
    </div>

    <% form_for [@user, @task] do |f| %>
      <div class="fields">
        <%= f.label :content %>
        <%= f.text_field :content %>
      </div>
      <%= f.hidden_field :project_id, :value => project.id %>
      <div class="actions">
        <%= f.submit 'Add task' %>
      </div>
    <% end %>

  <% end %>
</div>